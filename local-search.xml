<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改</title>
    <link href="/2023/11/10/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91%E8%BF%99%E6%A1%A3%E4%BA%8B-%E7%AC%AC%E4%BA%8C%E8%AF%BE%E3%80%81%E5%88%9D%E5%A7%8BAPK%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84%E3%80%81%E5%8F%8C%E5%BC%80%E3%80%81%E6%B1%89%E5%8C%96%E3%80%81%E5%9F%BA%E7%A1%80%E4%BF%AE%E6%94%B9/"/>
    <url>/2023/11/10/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91%E8%BF%99%E6%A1%A3%E4%BA%8B-%E7%AC%AC%E4%BA%8C%E8%AF%BE%E3%80%81%E5%88%9D%E5%A7%8BAPK%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84%E3%80%81%E5%8F%8C%E5%BC%80%E3%80%81%E6%B1%89%E5%8C%96%E3%80%81%E5%9F%BA%E7%A1%80%E4%BF%AE%E6%94%B9/</url>
    
    <content type="html"><![CDATA[<h1 id="1、APK结构"><a href="#1、APK结构" class="headerlink" title="1、APK结构"></a>1、APK结构</h1><p>apk 全称 Android Package，它相当于一个压缩文件，只要在电脑上将apk后缀改为zip即可解压。</p><table><thead><tr><th>文件</th><th>注释</th></tr></thead><tbody><tr><td>assets目录</td><td>存放APK的静态资源文件，比如视频，音频，图片等</td></tr><tr><td>lib 目录</td><td>armeabi-v7a基本通用所有android设备，arm64-v8a只适用于64位的android设备，x86常见用于android模拟器，其目录下的.so文件是c或c++编译的动态链接库文件</td></tr><tr><td>META_INF目录</td><td>保存应用的签名信息，签名信息可以验证APK文件的完整性，相当于APK的身份证(验证文件是否又被修改)</td></tr><tr><td>res目录</td><td>res目录存放资源文件，包括图片，字符串等等，APK的脸蛋由他的layout文件设计<br/>layout 文件夹用来存放布局文件，布局文件用来描述应用程序的界面结构。<br/>values 文件夹用来存放值资源文件，值资源文件用来存放应用程序中使用的常量值和颜色信息。</td></tr><tr><td>AndroidMainfest.xml文件</td><td>APK的应用清单信息，它描述了应用的名字，版本，权限，引用的库文件等等信息</td></tr><tr><td>classes.dex文件</td><td>classes.dex是java源码编译后生成的java字节码文件，APK运行的主要逻辑</td></tr><tr><td>resources.arsc文件</td><td>resources.arsc是编译后的二进制资源文件，它是一个映射表，映射着资源和id，通过R文件中的id就可以找到对应的资源</td></tr></tbody></table><h1 id="2、双开及原理"><a href="#2、双开及原理" class="headerlink" title="2、双开及原理"></a>2、双开及原理</h1><p>双开：简单来说，就是手机同时运行两个或多个相同的应用，例如同时运行两个微信等</p><table><thead><tr><th>原理</th><th>解释</th></tr></thead><tbody><tr><td>修改包名</td><td>让手机系统认为这是2个APP，这样的话就能生成2个数据存储路径，此时的多开就等于你打开了两个互不干扰的APP</td></tr><tr><td>修改Framework</td><td>对于有系统修改权限的厂商，可以修改Framework来实现双开的目的，例如：小米自带的应用多开</td></tr><tr><td>通过虚拟化技术实现</td><td>虚拟Framework层、虚拟文件系统、模拟Android对组件的管理、虚拟应用进程管理 等一整套虚拟技术，将APK复制一份到虚拟空间中运行，例如：平行空间</td></tr><tr><td>以插件机制运行</td><td>利用反射替换，动态代{过}{滤}理，hook了系统的大部分与system—server进程通讯的函数，以此作为“欺上瞒下”的目的，欺骗系统“以为”只有一个apk在运行，瞒过插件让其“认为”自己已经安装。例如：VirtualApp</td></tr></tbody></table><h2 id="2-1、修改包名实现双开"><a href="#2-1、修改包名实现双开" class="headerlink" title="2.1、修改包名实现双开"></a>2.1、修改包名实现双开</h2><h3 id="2-1-1-使用NP管理器自带功能修改包名实现双开"><a href="#2-1-1-使用NP管理器自带功能修改包名实现双开" class="headerlink" title="2.1.1 使用NP管理器自带功能修改包名实现双开"></a>2.1.1 使用NP管理器自带功能修改包名实现双开</h3><p>使用NP管理器提取APK安装包<br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image.png width=38%/></p><p>点击apk文件-&gt;功能-&gt;APK共存 输入新包名或者直接使用给出的新包名-&gt;确定-&gt;点击新生成的apk文件-&gt;安装<br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-1.png width=38%/><br>注意：因为此双开方式是修改包名实现的，动了应用的签名信息，如果开发者做了签名校验，打开更改过包名的应用会有可能会出现闪退崩溃的情况<br>可以使用开发者助手查看包名与签名的MD5<br>包名：com.zj.wuaipojie<br>签名MD5：A3:1F:3A:26:F7:0B:34:84:F0:7A:8B:A9:42:AA:1E:0D<br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-3.png width=38%/><br>包名：com.zj.wuaipojiep<br>签名MD5：68:17:0B:6B:26:E5:23:38:BC:07:AE:66:53:03:CC:36<br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-4.png width=38%/></p><h3 id="2-1-2-使用MT管理器手动修改包名实现双开"><a href="#2-1-2-使用MT管理器手动修改包名实现双开" class="headerlink" title="2.1.2 使用MT管理器手动修改包名实现双开"></a>2.1.2 使用MT管理器手动修改包名实现双开</h3><p>点击APK文件-&gt;查看-&gt;点击AndroidMainifest.xml文件-&gt;打开方式 反编译-&gt;修改package的值就是新的包名<br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-5.png width=38%/><br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-6.png width=38%/><br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-7.png width=38%/><br>MT管理器重新签名后的变化<br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-8.png width=38%/><br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-9.png width=38%/><br>包名：com.zj.wuaipojie.ok<br>签名MD5：E8:9B:15:8E:4B:CF:98:8E:BD:09:EB:83:F5:37:8E:87<br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-10.png width=38%/></p><h1 id="3、汉化APK"><a href="#3、汉化APK" class="headerlink" title="3、汉化APK"></a>3、汉化APK</h1><p>汉化：使用专门的工具对外文版的软件资源进行读取、翻译、修改、回写等一系列处理，使软件的菜单、对话框、提示等用户界面显示为中文，而程序的内核和功能保持不变，这个过程即为软件汉化</p><p>基本上字符串都是在arsc里，建议一键汉化，然后再润色。 少量没汉化到的字符串参考视频中的方法定位去逐个汉化。<br>这里还需要注意的是，如果要直装应用，那就应该先签名安装，看看是否有签名校验导致的闪退！！！<br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-11.png width=85%/></p><h2 id="3-1、XMl汉化"><a href="#3-1、XMl汉化" class="headerlink" title="3.1、XMl汉化"></a>3.1、XMl汉化</h2><p>打开课件中的Demo，点击挑战-&gt;第一关，先来汉化这一句<br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-12.png width=38%/><br>点击APK文件-&gt;查看-&gt;右上的三个点-&gt;XML搜索-&gt;点击搜索到的文件，再点击Jf.xml-&gt;反编译-&gt;修改此处，回编译-&gt;签名，返回到APK文件点击安装，直接安装会提示“安装失败，与已安装APK签名不一致！”，卸载原来的应用，然后再来这里进行安装<br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-13.png width=38%/><br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-14.png width=38%/><br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-15.png width=38%/><br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-16.png width=38%/><br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-17.png width=38%/><br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-18.png width=38%/><br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-19.png width=38%/><br>修改后的效果<br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-20.png width=38%/></p><h2 id="3-2、Arsc汉化"><a href="#3-2、Arsc汉化" class="headerlink" title="3.2、Arsc汉化"></a>3.2、Arsc汉化</h2><p>汉化这句俄语，使用开发者助手应用进行提取<br>Я не могу поверить, что это работает, почему?<br>查看APK点击右上角三个点-&gt;搜索-&gt;高级搜索-&gt;翻译模式-&gt;找到需要翻译的俄语，修改过后退出（保存退出）*2，签名-&gt;安装<br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-21.png width=38%/><br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-22.png width=38%/><br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-23.png width=38%/><br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-24.png width=38%/><br>在我看来，困惑是学习过程的第一阶段，这说明固有知识的局限开始被打破了。你要直面新的信息，这些新的信息会挑战你现有的观念和行为模式。由此产生的焦虑是让你改变的动力，很可能也会开启你的创造力。<br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-25.png width=38%/><br>最终效果<br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-26.png width=38%/></p><h2 id="3-1、DEX汉化"><a href="#3-1、DEX汉化" class="headerlink" title="3.1、DEX汉化"></a>3.1、DEX汉化</h2><p>先使用开发者助手提取这段话，回到MT管理器查看APK-&gt;右上角三个点 搜索（高级搜索），打开方式 Dex编辑器++ -&gt;搜索，编辑保存，退回 保存 编译dex 签名 安装<br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-27.png width=38%/><br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-28.png width=38%/><br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-29.png width=38%/><br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-30.png width=38%/><br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-31.png width=38%/><br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-32.png width=38%/><br>最终效果<br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-33.png width=38%/></p><h1 id="4、初识AndroidMainfest-xml"><a href="#4、初识AndroidMainfest-xml" class="headerlink" title="4、初识AndroidMainfest.xml"></a>4、初识AndroidMainfest.xml</h1><p>AndroidManifest.xml文件是整个应用程序的信息描述文件，定义了应用程序中包含的Activity,Service,Content provider和BroadcastReceiver组件信息。每个应用程序在根目录下必须包含一个AndroidManifest.xml文件，且文件名不能修改。它描述了package中暴露的组件，他们各自的实现类，各种能被处理的数据和启动位置。</p><table><thead><tr><th>属性</th><th>定义</th></tr></thead><tbody><tr><td>versionCode</td><td>版本号，主要用来更新，例如:12</td></tr><tr><td>versionName</td><td>版本名，给用户看的，例如:1.2</td></tr><tr><td>package</td><td>包名，例如：com.zj.52pj.demo</td></tr><tr><td>uses-permission android:name&#x3D;””</td><td>应用权限，例如：android.permission.INTERNET 代表网络权限</td></tr><tr><td>android:label&#x3D;”@string&#x2F;app_name”</td><td>应用名称</td></tr><tr><td>android:icon&#x3D;”@mipmap&#x2F;ic_launcher”</td><td>应用名称</td></tr><tr><td>android:debuggable&#x3D;”true”</td><td>应用是否开启debug权限</td></tr></tbody></table><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-34.png width=38%/><h1 id="5、修改图标、修改名字-课后小作业"><a href="#5、修改图标、修改名字-课后小作业" class="headerlink" title="5、修改图标、修改名字 + 课后小作业"></a>5、修改图标、修改名字 + 课后小作业</h1><h2 id="5-1、修改图标、应用名字"><a href="#5-1、修改图标、应用名字" class="headerlink" title="5.1、修改图标、应用名字"></a>5.1、修改图标、应用名字</h2><p>adb传入图片-&gt;打开np管理器-&gt;点击APK文件-&gt;功能（通用编辑）-&gt;修改后保存-&gt;这个时候的签名有所变化，变成了np管理器默认的签名，所以需要卸载原来的应用<br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-35.png width=80%/><br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-36.png width=38%/><br>最终效果<br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-37.png width=38%/><br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-38.png width=38%/></p><h2 id="5-2、课后小作业-替换第一关挑战中的图片"><a href="#5-2、课后小作业-替换第一关挑战中的图片" class="headerlink" title="5.2、课后小作业-替换第一关挑战中的图片"></a>5.2、课后小作业-替换第一关挑战中的图片</h2><p>res目录存放资源文件，包括图片，字符串等等，所以这个挑战的图片就在res这个目录里，也可使用开发者助手辅助，然后搜索<br>打开APK文件进入res目录，找到需要修改的图片cf.jpg，右边目录找到图片目录，重命名为cf.jpg然后复制过去-&gt;确定（自动）-&gt;安装，这时是MT管理器默认的应用签名<br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-39.png width=38%/><br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-40.png width=38%/><br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-41.png width=38%/><br>最终效果<br><img src=安卓逆向这档事-第二课、初始APK文件结构、双开、汉化、基础修改/image-42.png width=38%/></p>]]></content>
    
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>初试Frida</title>
    <link href="/2023/11/06/%E5%88%9D%E8%AF%95Frida/"/>
    <url>/2023/11/06/%E5%88%9D%E8%AF%95Frida/</url>
    
    <content type="html"><![CDATA[<p>工具说明：</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">Frida<br><span class="hljs-keyword">Android </span>Studio<br><span class="hljs-keyword">jadx-gui</span><br><span class="hljs-keyword"></span>一部测试机（已Root）<br></code></pre></td></tr></table></figure><p>尝试Frida Hook一个简单的Android程序<br>Android Stdio新建一个项目<br><img src="/%E5%88%9D%E8%AF%95Frida/image.png"><br><img src="/%E5%88%9D%E8%AF%95Frida/image-1.png"></p><p><img src="/%E5%88%9D%E8%AF%95Frida/image-2.png"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs XML"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">androidx.constraintlayout.widget.ConstraintLayout</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">xmlns:app</span>=<span class="hljs-string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">xmlns:tools</span>=<span class="hljs-string">&quot;http://schemas.android.com/tools&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;match_parent&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;match_parent&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">tools:context</span>=<span class="hljs-string">&quot;.MainActivity&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:id</span>=<span class="hljs-string">&quot;@+id/textView&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:text</span>=<span class="hljs-string">&quot;文本框&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">app:layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">&quot;parent&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">app:layout_constraintEnd_toEndOf</span>=<span class="hljs-string">&quot;parent&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">app:layout_constraintStart_toStartOf</span>=<span class="hljs-string">&quot;parent&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">app:layout_constraintTop_toTopOf</span>=<span class="hljs-string">&quot;parent&quot;</span> /&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">Button</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:id</span>=<span class="hljs-string">&quot;@+id/button&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:text</span>=<span class="hljs-string">&quot;按钮&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">tools:ignore</span>=<span class="hljs-string">&quot;MissingConstraints&quot;</span>/&gt;</span><br><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/%E5%88%9D%E8%AF%95Frida/image-3.png"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">View</span>.OnClickListener &#123;<br><br>    <span class="hljs-keyword">private</span> TextView tv;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);<br>        setContentView(R.layout.activity_main);<br>        tv = findViewById(R.id.textView);<br>        findViewById(R.id.button).setOnClickListener(<span class="hljs-built_in">this</span>);<br>    &#125;<br><br><br>    <span class="hljs-meta">@SuppressLint(&quot;SetTextI18n&quot;)</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClick</span><span class="hljs-params">(View v)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">number1</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">number2</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>;<br>        tv.setText(<span class="hljs-string">&quot;value1 + value2 = &quot;</span> + addab(number1, number2));<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">addab</span><span class="hljs-params">(<span class="hljs-type">int</span> value1, <span class="hljs-type">int</span> value2)</span>&#123;<br>        <span class="hljs-keyword">return</span> value1 + value2;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>连接PC端运行会自动安装在测试机<br>本地也会输出一个apk文件<br><img src="/%E5%88%9D%E8%AF%95Frida/image-4.png"><br>拖入jadx-gui逆向代码（因为我们直接用源代码，这一步可有可不有）</p><p>入口：com.example.hook_demo.MainActivity<br>双击进入代码<br><img src="/%E5%88%9D%E8%AF%95Frida/image-5.png"><br><img src="/%E5%88%9D%E8%AF%95Frida/image-6.png"><br>点击按钮呈现的效果<br><img src="/%E5%88%9D%E8%AF%95Frida/image-7.png"></p><p>addab函数有value1、value2两个int值，返回value1、value2相加的值<br>按钮被触发之后onClick函数将1、2传入addab函数，addab函数返回相加值<br><img src="/%E5%88%9D%E8%AF%95Frida/image-8.png"></p><p>hook效果：改变返回值，或者改变传入addab函数的值从而改变结果</p><p>第一种改变addab的返回值</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Hook 开始！&quot;</span>);<br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">MainActivity</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.example.hook_demo.MainActivity&quot;</span>);<br>    <span class="hljs-title class_">MainActivity</span>.<span class="hljs-property">addab</span>.<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>)&#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;--&quot;</span>, <span class="hljs-string">&quot;返回100&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">100</span>;<br>    &#125;<br>&#125;);<br></code></pre></td></tr></table></figure><p>测试机启动Frida-sever<br>frida-ps -Ua查看进程<br>frida -U Hook_Demo -l hook.js</p><p><img src="/%E5%88%9D%E8%AF%95Frida/image-9.png"><br><img src="/%E5%88%9D%E8%AF%95Frida/image-10.png"></p><p>第二种改变a, b的值（刚学习Frida，写的不好的地方还请多多指教）</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs arcade">Java.perform(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(<span class="hljs-string">&quot;Hook 开始！&quot;</span>);<br>    <span class="hljs-keyword">var</span> MainActivity = Java.use(<span class="hljs-string">&quot;com.example.hook_demo.MainActivity&quot;</span>);<br>    <span class="hljs-comment">// 第一种改变addab的返回值</span><br>    <span class="hljs-comment">// MainActivity.addab.implementation = function(a, b)&#123;</span><br>    <span class="hljs-comment">//     console.log(&quot;--&quot;, &quot;返回100&quot;);</span><br>    <span class="hljs-comment">//     return 100;</span><br>    <span class="hljs-comment">// &#125;</span><br><br>    <span class="hljs-comment">// 第二种改变a, b的值</span><br>    MainActivity.addab.overload(<span class="hljs-string">&quot;int&quot;</span>, <span class="hljs-string">&quot;int&quot;</span>).implementation = <span class="hljs-keyword">function</span>(<span class="hljs-params">value1, value2</span>)&#123;<br>        <span class="hljs-keyword">var</span> result = this.value1 + this.value2;<br>        <span class="hljs-comment">//  改变前的值  1、2</span><br>        <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(<span class="hljs-string">&quot;改变前的值:&quot;</span>, value1, value2);<br>        value1 = <span class="hljs-number">100</span>, value2 = <span class="hljs-number">200</span>;<br>        <span class="hljs-comment">// 改后后的值   100、200</span><br>        <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(<span class="hljs-string">&quot;改后后的值:&quot;</span>, value1, value2,);<br>        <span class="hljs-keyword">return</span> value1 + value2;<br>    &#125;<br>&#125;);<br></code></pre></td></tr></table></figure><p><img src="/%E5%88%9D%E8%AF%95Frida/image-11.png"><br><img src="/%E5%88%9D%E8%AF%95Frida/image-12.png"></p>]]></content>
    
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
